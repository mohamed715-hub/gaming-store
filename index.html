<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PRO GAMER CATALOG</title>
    
    <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/808/808439.png" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&family=Rajdhani:wght@600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <style>
        :root { --main: #ff0000; --gold: #ffd700; --bg: #0a0a0a; --card: #141414; }
        body { background: var(--bg); color: white; font-family: 'Cairo', sans-serif; margin: 0; padding-bottom: 80px; overflow-x: hidden; }
        * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #000; }
        ::-webkit-scrollbar-thumb { background: var(--main); border-radius: 4px; }

        /* Loader */
        #globalLoader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #0a0a0a; z-index: 9999;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            transition: opacity 0.5s ease-out, visibility 0.5s ease-out;
        }
        .loader-spinner {
            width: 60px; height: 60px; border: 5px solid #222; border-top: 5px solid var(--main);
            border-radius: 50%; animation: spin 1s linear infinite; margin-bottom: 20px;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.3);
        }
        .loader-text { font-family: 'Rajdhani', sans-serif; font-size: 24px; font-weight: 900; animation: pulse 1.5s infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .hidden-loader { opacity: 0; visibility: hidden; pointer-events: none; }

        /* Header */
        header { background: #000; padding: 10px 5%; border-bottom: 2px solid var(--main); display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 1000; box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
        .logo { text-decoration: none; display: flex; align-items: center; gap: 10px; }
        .logo-text { font-family: 'Rajdhani', sans-serif; font-size: 22px; font-weight: 900; color: #fff; line-height: 1; display: flex; flex-direction: column; }
        .logo-icon { font-size: 28px; color: var(--main); }
        
        .search-container { flex-grow: 1; max-width: 500px; margin: 0 15px; position: relative; }
        .search-container input { width: 100%; padding: 8px 35px 8px 15px; border-radius: 20px; border: 1px solid #333; background: #1a1a1a; color: #fff; outline: none; transition: 0.3s; }
        .search-container input:focus { border-color: var(--main); box-shadow: 0 0 10px rgba(255, 0, 0, 0.2); }
        .search-icon { position: absolute; right: 12px; top: 50%; transform: translateY(-50%); color: #666; font-size: 14px; }

        /* Slider */
        .hero-slider-container { width: 95%; max-width: 600px; height: 200px; margin: 20px auto; position: relative; border-radius: 15px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.6); display: none; border: 1px solid #333; }
        @media(min-width: 768px) { .hero-slider-container { height: 350px; } }
        .slide { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-size: cover; background-position: center; opacity: 0; transition: opacity 0.8s; }
        .slide.active { opacity: 1; }
        .slide-content { position: absolute; bottom: 0; left: 0; width: 100%; background: linear-gradient(to top, rgba(0,0,0,0.9), transparent); padding: 20px; text-align: center; }
        .slide-title { font-size: 20px; font-weight: 900; font-family: 'Rajdhani'; text-shadow: 0 2px 5px #000; }

        /* Categories */
        .categories-nav { padding: 10px 5%; display: flex; gap: 8px; overflow-x: auto; white-space: nowrap; scrollbar-width: none; background: #111; }
        .categories-nav::-webkit-scrollbar { display: none; }
        .cat-btn { background: #222; color: #aaa; border: 1px solid #333; padding: 6px 14px; border-radius: 20px; cursor: pointer; transition: 0.3s; font-size: 13px; display: flex; align-items: center; gap: 5px; }
        .cat-btn.active, .cat-btn:hover { background: var(--main); color: #fff; border-color: var(--main); }

        /* Grid & Cards */
        .container { max-width: 1200px; margin: 0 auto; padding: 10px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px; }
        @media(min-width: 768px) { .grid { grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; } }

        .card { background: var(--card); border-radius: 10px; overflow: hidden; border: 1px solid #222; transition: 0.2s; position: relative; display: flex; flex-direction: column; }
        .card:hover { border-color: var(--main); transform: translateY(-3px); }
        .card.selected { border-color: var(--gold); box-shadow: 0 0 10px rgba(255,215,0,0.2); }
        .card.selected .select-btn i { display: block; }
        
        .card-img-wrapper { position: relative; height: 140px; overflow: hidden; }
        .card img { width: 100%; height: 100%; object-fit: cover; }
        
        .size-tag { position: absolute; top: 5px; left: 5px; background: rgba(0,0,0,0.8); padding: 2px 6px; border-radius: 4px; font-size: 11px; font-weight: bold; border: 1px solid var(--main); font-family: 'Rajdhani'; z-index: 2; }
        .online-tag { background: var(--gold); color: #000; border: none; }
        
        .card-content { padding: 10px; flex-grow: 1; display: flex; flex-direction: column; }
        .card-title { font-size: 14px; font-weight: bold; margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; color: #fff; }
        .card-desc { font-size: 10px; color: #888; background: #000; padding: 5px; border-radius: 4px; margin-bottom: 8px; min-height: 25px; line-height: 1.3; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; }
        
        .card-footer { display: flex; justify-content: space-between; align-items: center; margin-top: auto; }
        .add-btn { background: var(--main); color: #fff; border: none; padding: 5px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; font-weight: bold; width: 100%; transition: 0.2s; }
        .card.selected .add-btn { background: #25D366; }

        /* Admin */
        .admin-box { display: none; background: #1a1a1a; padding: 20px; border-radius: 10px; border: 1px solid var(--main); margin: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
        .admin-input, .admin-select { width: 100%; padding: 10px; margin-bottom: 10px; background: #000; border: 1px solid #333; color: white; border-radius: 5px; outline: none; }
        .gear { position: fixed; bottom: 20px; left: 20px; width: 45px; height: 45px; background: #222; border-radius: 50%; display: flex; align-items: center; justify-content: center; border: 1px solid var(--main); cursor: pointer; z-index: 100; color: var(--main); transition: 0.3s; }
        .gear:hover { transform: rotate(90deg); }

        /* Cart Float */
        .cart-float { position: fixed; bottom: 20px; right: 20px; background: #25D366; color: white; padding: 12px 25px; border-radius: 30px; font-weight: bold; cursor: pointer; z-index: 999; display: none; align-items: center; gap: 8px; box-shadow: 0 5px 15px rgba(37, 211, 102, 0.4); animation: popUp 0.3s; }
        @keyframes popUp { from { transform: scale(0); } to { transform: scale(1); } }
        
        /* Cart Modal */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 2000; display: none; align-items: center; justify-content: center; backdrop-filter: blur(5px); }
        .modal-content { background: #141414; width: 90%; max-width: 450px; max-height: 85vh; border-radius: 15px; border: 1px solid #333; padding: 20px; overflow-y: auto; position: relative; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        .close-modal { position: absolute; top: 10px; right: 15px; font-size: 24px; cursor: pointer; color: #fff; }
        
        .cart-item { display: flex; justify-content: space-between; align-items: center; background: #222; padding: 10px; margin-bottom: 8px; border-radius: 8px; border: 1px solid #333; }
        .cart-info { font-size: 13px; }
        .cart-info div { margin-bottom: 2px; font-weight: bold; }
        .remove-item { color: #ff4444; cursor: pointer; padding: 5px; }
        
        .checkout-btn { width: 100%; background: #25D366; color: white; border: none; padding: 12px; border-radius: 25px; font-weight: bold; font-size: 16px; margin-top: 15px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; transition: 0.2s; }
        .checkout-btn:hover { background: #20bd5a; transform: scale(1.02); }
        
        .not-found { grid-column: 1/-1; text-align: center; padding: 40px; color: #777; }
        
        /* Offer Styles - Removed Price but kept Visuals */
        .offer-card { border: 2px solid var(--gold) !important; background: linear-gradient(180deg, #1a1a1a, #0d0d0d); }
        .offer-badge { background: var(--gold); color: #000; text-align: center; font-weight: bold; font-size: 12px; padding: 2px; }
    </style>
</head>
<body>

    <div id="globalLoader">
        <div class="loader-spinner"></div>
        <div class="loader-text">PRO GAMER STORE</div>
    </div>

    <div class="gear" onclick="toggleAdmin()"><i class="fa-solid fa-cog"></i></div>

    <header>
        <a href="#" class="logo" onclick="window.scrollTo(0,0)">
            <i class="fa-solid fa-gamepad logo-icon"></i>
            <div class="logo-text">
                <span>PRO</span><span style="color:var(--main)">GAMER</span>
            </div>
        </a>
        <div class="search-container">
            <input type="text" id="searchInput" placeholder="Ø¨Ø­Ø« Ø¹Ù† Ù„Ø¹Ø¨Ø©..." onkeyup="render()">
            <i class="fa-solid fa-search search-icon"></i>
        </div>
    </header>

    <div class="container">
        <div class="admin-box" id="adminPanel">
            <h3 style="color:var(--main); margin-top:0;">ğŸ® Ø¥Ø¶Ø§ÙØ© Ù„Ø¹Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø©</h3>
            <input type="text" id="gName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù„Ø¹Ø¨Ø©" class="admin-input">
            <input type="text" id="gSize" placeholder="Ø§Ù„Ù…Ø³Ø§Ø­Ø© (GB)" class="admin-input">
            <input type="text" id="gImage" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©" class="admin-input">
            <input type="text" id="gVideo" placeholder="Ø±Ø§Ø¨Ø· ÙŠÙˆØªÙŠÙˆØ¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" class="admin-input">
            <input type="text" id="gDesc" placeholder="Ø§Ù„ÙˆØµÙ" class="admin-input">
            
            <select id="gCat" class="admin-select">
                <option value="action">Ø£ÙƒØ´Ù† (Action)</option>
                <option value="adventure">Ù…ØºØ§Ù…Ø±Ø§Øª (Adventure)</option>
                <option value="cars">Ø³ÙŠØ§Ø±Ø§Øª (Racing)</option>
                <option value="horror">Ø±Ø¹Ø¨ (Horror)</option>
                <option value="sports">Ø±ÙŠØ§Ø¶Ø© (Sports)</option>
                <option value="openworld">Ø¹Ø§Ù„Ù… Ù…ÙØªÙˆØ­ (Open World)</option>
                <option value="online">Ø£ÙˆÙ†Ù„Ø§ÙŠÙ† (Online)</option>
                <option value="bundles">Ø¨Ø§Ù‚Ø© / Ø¹Ø±Ø¶</option>
            </select>

            <div style="margin-bottom:10px;">
                <input type="checkbox" id="gFeatured"> <label>Ø¹Ø±Ø¶ ÙÙŠ Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø±</label>
            </div>

            <button onclick="addGame()" class="checkout-btn" style="width:100%; margin-top:0; background:var(--main)">Ø­ÙØ¸ Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
            <div style="margin-top:10px; font-size:12px; color:#555;">Ø¹Ø¯Ø¯ Ø§Ù„Ø²ÙˆØ§Ø±: <span id="vCount">0</span></div>
        </div>

        <div class="hero-slider-container" id="heroSlider">
            <div class="slider-wrapper" id="sliderWrapper"></div>
        </div>

        <div class="categories-nav">
            <div class="cat-btn active" onclick="filter('all', this)">Ø§Ù„ÙƒÙ„</div>
            <div class="cat-btn" onclick="filter('online', this)">ğŸ”¥ Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†</div>
            <div class="cat-btn" onclick="filter('bundles', this)">ğŸ Ø¹Ø±ÙˆØ¶</div>
            <div class="cat-btn" onclick="filter('action', this)">Ø£ÙƒØ´Ù†</div>
            <div class="cat-btn" onclick="filter('adventure', this)">Ù…ØºØ§Ù…Ø±Ø§Øª</div>
            <div class="cat-btn" onclick="filter('cars', this)">Ø³ÙŠØ§Ø±Ø§Øª</div>
            <div class="cat-btn" onclick="filter('sports', this)">Ø±ÙŠØ§Ø¶Ø©</div>
            <div class="cat-btn" onclick="filter('horror', this)">Ø±Ø¹Ø¨</div>
        </div>

        <div class="grid" id="gamesGrid" style="margin-top:20px;"></div>
    </div>

    <div class="cart-float" id="cartFloat" onclick="openCart()">
        <i class="fa-solid fa-check-double"></i> 
        <span>Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± (<span id="cartTotalBadge">0</span>)</span>
    </div>

    <div class="modal-overlay" id="cartModal">
        <div class="modal-content">
            <div class="close-modal" onclick="closeCart()">&times;</div>
            <h2 style="margin-top:0; font-family:'Rajdhani'; border-bottom:1px solid #333; padding-bottom:10px;">Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø© ğŸ“‹</h2>
            
            <div style="background:#222; padding:10px; border-radius:5px; margin-bottom:15px; font-size:13px; text-align:center;">
                <div id="storageInfo" style="font-weight:bold; color:var(--gold)"></div>
            </div>

            <div id="cartList" style="max-height:40vh; overflow-y:auto;"></div>

            <div style="border-top:1px solid #333; margin-top:15px; padding-top:10px;">
                <div style="font-size:12px; color:#777; text-align:center; margin-bottom:10px;">
                    Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨ Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ØªÙƒÙ„ÙØ© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©
                </div>
                <button class="checkout-btn" onclick="checkout()">
                    <i class="fa-brands fa-whatsapp"></i> Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
                </button>
                <button onclick="clearCart()" style="width:100%; background:none; border:1px solid #444; color:#ff4444; padding:8px; border-radius:20px; margin-top:10px; cursor:pointer;">Ø¥ÙØ±Ø§Øº Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</button>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getFirestore, collection, addDoc, onSnapshot, doc, deleteDoc, updateDoc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ÙØ§ÙŠØ±Ø¨ÙŠØ³
        const firebaseConfig = {
            apiKey: "AIzaSyB...",
            authDomain: "gamer-store-77.firebaseapp.com",
            projectId: "gamer-store-77",
            storageBucket: "gamer-store-77.appspot.com",
            messagingSenderId: "539826372007",
            appId: "1:539826372007:web:c8e76a..."
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        let games = [];
        let cart = JSON.parse(localStorage.getItem('myCart')) || [];
        let currentCat = 'all';
        let isAdmin = false;

        window.onload = () => {
            setTimeout(() => document.getElementById('globalLoader').classList.add('hidden-loader'), 1500);
            updateVisits();
        };

        async function updateVisits() {
            const ref = doc(db, "settings", "stats");
            try {
                await setDoc(ref, { visits: (await getDoc(ref)).data()?.visits + 1 || 1 }, { merge: true });
            } catch(e) {}
        }

        // Ø¬Ù„Ø¨ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ (Ø¨Ø¯ÙˆÙ† Ø£Ø³Ø¹Ø§Ø±)
        onSnapshot(collection(db, "games"), (snap) => {
            games = snap.docs.map(d => ({ id: d.id, ...d.data() }));
            render();
            updateCartUI();
            initSlider();
        });

        window.render = () => {
            const grid = document.getElementById("gamesGrid");
            grid.innerHTML = "";
            const search = document.getElementById("searchInput").value.toLowerCase();
            
            const filtered = games.filter(g => {
                const matchSearch = g.name.toLowerCase().includes(search);
                const matchCat = currentCat === 'all' ? true : g.cat === currentCat;
                return matchSearch && matchCat;
            });

            if(!filtered.length) {
                grid.innerHTML = `<div class="not-found">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù„Ø¹Ø§Ø¨ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø§Ø³Ù…</div>`;
                return;
            }

            filtered.forEach(g => {
                const isSelected = cart.includes(g.id);
                const isOnline = g.cat === 'online';
                const isBundle = g.cat === 'bundles';
                
                let label = isBundle ? 'Ø¨Ø§Ù‚Ø© Ø®Ø§ØµØ©' : (isOnline ? 'ONLINE' : `${g.size} GB`);
                let tagClass = isOnline ? 'online-tag' : '';
                
                const card = document.createElement("div");
                card.className = `card ${isSelected ? 'selected' : ''} ${isBundle ? 'offer-card' : ''}`;
                card.onclick = (e) => { if(!e.target.closest('button')) toggleCart(g.id); };
                
                card.innerHTML = `
                    ${isBundle ? '<div class="offer-badge">ğŸ”¥ Ø¹Ø±Ø¶ Ù…Ù…ÙŠØ²</div>' : ''}
                    <div class="size-tag ${tagClass}">${label}</div>
                    <div class="card-img-wrapper">
                        <img src="${g.image}" loading="lazy">
                    </div>
                    <div class="card-content">
                        <div class="card-title">${g.name}</div>
                        <div class="card-desc">${g.desc || (isOnline ? 'Ù„Ø¹Ø¨Ø© Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†' : 'Ù†Ø³Ø®Ø© Ø£ÙˆÙÙ„Ø§ÙŠÙ†')}</div>
                        <div class="card-footer">
                            <span style="font-size:12px; color:#aaa;">${isOnline ? 'ØªØ­ØªØ§Ø¬ ØªÙØ¹ÙŠÙ„' : 'ØªØ³Ø·ÙŠØ¨ Ù…Ø¨Ø§Ø´Ø±'}</span>
                            <button class="add-btn">${isSelected ? 'ØªÙ… Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± âœ”' : 'Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©'}</button>
                        </div>
                        ${isAdmin ? `<button onclick="delGame('${g.id}')" style="background:red; border:none; color:white; margin-top:5px; cursor:pointer;">Ù…Ø³Ø­</button>` : ''}
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        window.toggleCart = (id) => {
            if(cart.includes(id)) cart = cart.filter(i => i !== id);
            else {
                cart.push(id);
                const Toast = Swal.mixin({ toast: true, position: 'top-end', showConfirmButton: false, timer: 1000, background:'#25D366', color:'#fff' });
                Toast.fire({ icon: 'success', title: 'ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©' });
            }
            updateCartUI();
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ù„Ø© (Ø¨Ø¯ÙˆÙ† Ø£Ø³Ø¹Ø§Ø±)
        window.updateCartUI = () => {
            localStorage.setItem('myCart', JSON.stringify(cart));
            
            const list = document.getElementById("cartList");
            list.innerHTML = "";
            
            let totalSize = 0;
            let onlineCount = 0;
            let bundleCount = 0;

            games.forEach(g => {
                if(cart.includes(g.id)) {
                    let s = Number(g.size) || 0;
                    totalSize += s;
                    
                    if(g.cat === 'online') onlineCount++;
                    if(g.cat === 'bundles') bundleCount++;

                    let meta = g.cat === 'online' ? `Online | ${s}GB` : `${s} GB`;
                    if(g.cat === 'bundles') meta = "Ø¹Ø±Ø¶ Ø®Ø§Øµ";

                    list.innerHTML += `
                        <div class="cart-item">
                            <div class="cart-info">
                                <div style="font-weight:bold; color:#fff;">${g.name}</div>
                                <div style="color:#aaa;">${meta}</div>
                            </div>
                            <i class="fa-solid fa-trash remove-item" onclick="toggleCart('${g.id}')"></i>
                        </div>
                    `;
                }
            });

            document.getElementById("cartTotalBadge").innerText = cart.length;
            document.getElementById("cartFloat").style.display = cart.length > 0 ? "flex" : "none";
            
            document.getElementById("storageInfo").innerHTML = `
                <div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³Ø§Ø­Ø©: ${totalSize.toFixed(1)} GB</div>
                <div style="font-size:11px; color:#aaa; margin-top:5px;">Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨: ${cart.length}</div>
            `;

            render(); 
        }

        // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ (ØªÙ‚Ø±ÙŠØ± ÙÙ†ÙŠ ÙÙ‚Ø·)
        window.checkout = () => {
            let totalSize = 0;
            let onlineCount = 0;
            let list = "";

            games.forEach((g, i) => {
                if(cart.includes(g.id)) {
                    let s = Number(g.size) || 0;
                    totalSize += s;
                    
                    let type = "[Offline]";
                    if(g.cat === 'online') { type = "[Online ğŸŒ]"; onlineCount++; }
                    if(g.cat === 'bundles') { type = "[Bundle ğŸ]"; }

                    list += `${i+1}. ${g.name} (${s}GB) ${type}\n`;
                }
            });

            let msg = `ğŸ“‹ *Ø·Ù„Ø¨ Ø£Ù„Ø¹Ø§Ø¨ Ø¬Ø¯ÙŠØ¯* \n`;
            msg += `------------------\n`;
            msg += list;
            msg += `------------------\n`;
            msg += `ğŸ“Š *Ù…Ù„Ø®Øµ Ø§Ù„Ø·Ù„Ø¨:*\n`;
            msg += `ğŸ“¦ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨: ${cart.length}\n`;
            msg += `ğŸ’¾ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³Ø§Ø­Ø©: ${totalSize.toFixed(1)} GB\n`;
            msg += `ğŸŒ Ø£Ù„Ø¹Ø§Ø¨ Ø£ÙˆÙ†Ù„Ø§ÙŠÙ† (ØªÙØ¹ÙŠÙ„): ${onlineCount}\n`;
            msg += `\nğŸ’¬ *Ø¨Ø±Ø¬Ø§Ø¡ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ØªÙƒÙ„ÙØ© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©*`;

            window.open(`https://wa.me/201500372007?text=${encodeURIComponent(msg)}`, '_blank');
        }

        window.openCart = () => document.getElementById("cartModal").style.display = "flex";
        window.closeCart = () => document.getElementById("cartModal").style.display = "none";
        
        window.filter = (cat, btn) => {
            currentCat = cat;
            document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            render();
        }
        window.clearCart = () => {
            cart = [];
            updateCartUI();
            closeCart();
        }

        // Admin (Ø¨Ø¯ÙˆÙ† Ø£Ø³Ø¹Ø§Ø±)
        window.toggleAdmin = async () => {
            if(isAdmin) {
                isAdmin = false;
                document.getElementById("adminPanel").style.display = "none";
                render();
            } else {
                const { value: pass } = await Swal.fire({ title: 'Admin Password', input: 'password', background:'#111', color:'white' });
                if(pass === "372007") {
                    isAdmin = true;
                    document.getElementById("adminPanel").style.display = "block";
                    render();
                    const s = await getDoc(doc(db, "settings", "stats"));
                    if(s.exists()) document.getElementById("vCount").innerText = s.data().visits;
                }
            }
        }

        window.addGame = async () => {
            const name = document.getElementById("gName").value;
            const size = document.getElementById("gSize").value;
            const image = document.getElementById("gImage").value;
            const cat = document.getElementById("gCat").value;
            const desc = document.getElementById("gDesc").value;
            const video = document.getElementById("gVideo").value;
            const featured = document.getElementById("gFeatured").checked;

            if(!name || !size) return alert("Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ø§Ù‚ØµØ©");

            await addDoc(collection(db, "games"), {
                name, size: Number(size), image, cat, 
                desc, video, featured, createdAt: new Date()
            });
            
            Swal.fire({ icon: 'success', title: 'ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©', timer: 1000, showConfirmButton: false });
            document.getElementById("gName").value = "";
        }

        window.delGame = async (id) => {
            if(confirm("Ù…Ø³Ø­ Ø§Ù„Ù„Ø¹Ø¨Ø©ØŸ")) await deleteDoc(doc(db, "games", id));
        }

        function initSlider() {
            const wrapper = document.getElementById("sliderWrapper");
            const feats = games.filter(g => g.featured);
            const container = document.getElementById("heroSlider");
            
            if(!feats.length) { container.style.display = "none"; return; }
            container.style.display = "block";
            wrapper.innerHTML = "";

            feats.forEach((g, i) => {
                const div = document.createElement("div");
                div.className = i === 0 ? "slide active" : "slide";
                div.style.backgroundImage = `url('${g.image}')`;
                div.innerHTML = `<div class="slide-content"><div class="slide-title">${g.name}</div></div>`;
                wrapper.appendChild(div);
            });

            let idx = 0;
            setInterval(() => {
                const slides = document.querySelectorAll(".slide");
                if(!slides.length) return;
                slides[idx].classList.remove("active");
                idx = (idx + 1) % slides.length;
                slides[idx].classList.add("active");
            }, 3000);
        }
    </script>
</body>
</html>
